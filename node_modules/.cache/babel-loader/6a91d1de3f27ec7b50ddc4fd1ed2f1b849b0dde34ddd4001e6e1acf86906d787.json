{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{useParams}from'react-router-dom';import{useNavigate}from\"react-router-dom\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function PostDetails(){const navigate=useNavigate();const{id}=useParams();// Access the route parameter\nconst[data,setData]=useState();const[commentData,setCommentData]=useState([]);const[isLoading,setIsLoading]=useState(false);const[error,setError]=useState(null);const currentUserToken=localStorage.getItem('token');const deleteComment=async data=>{try{const response=await fetch(\"http://localhost:3000/posts/\".concat(id,\"/comments/\").concat(data._id),{method:'DELETE',headers:{'Content-Type':'application/json',Authorization:currentUserToken// Set your headers if needed\n// Add any other necessary headers\n}// You can include a body for some DELETE requests, but it's often not required\n// body: JSON.stringify({ /* any data if needed */ }),\n});if(!response.ok){throw new Error('Network response was not ok');}// Handle success if needed\nconsole.log('Item deleted successfully');window.location.reload();}catch(error){// Handle error if any\nconsole.error('There was a problem deleting the item:',error);}};const deletePost=async e=>{e.preventDefault();try{const response=await fetch(\"http://localhost:3000/posts/\".concat(id),{method:'DELETE',headers:{'Content-Type':'application/json',Authorization:currentUserToken// Set your headers if needed\n// Add any other necessary headers\n}// You can include a body for some DELETE requests, but it's often not required\n// body: JSON.stringify({ /* any data if needed */ }),\n});if(!response.ok){throw new Error('Network response was not ok');}// Handle success if needed\nconsole.log('Item deleted successfully');navigate(\"/\");}catch(error){// Handle error if any\nconsole.error('There was a problem deleting the item:',error);}};const ChangeRouteToUpdatePostForm=id=>{navigate(\"/update-posts/\"+id);};const ChangeRouteToUpdateCommentForm=(id,data)=>{navigate(\"/update-comments/\"+id+\"/\"+data._id);};const ChangeRouteToCommentForm=id=>{navigate(\"/comment-form/\"+id);};useEffect(()=>{const fetchData=async()=>{try{const response=await fetch('http://localhost:3000/posts/'+id+'/comments');if(!response.ok){throw new Error('Network response was not ok.');}const resultComments=await response.json();setCommentData(resultComments.comments);}catch(error){setError(error);}finally{setIsLoading(false);}};fetchData();},[id]);useEffect(()=>{const fetchData=async()=>{try{const response=await fetch('http://localhost:3000/posts/'+id);if(!response.ok){throw new Error('Network response was not ok.');}const result=await response.json();setIsLoading(true);setData(result.post);}catch(error){setIsLoading(true);setError(error);}};fetchData();},[error,id,isLoading]);let currentUser=JSON.parse(localStorage.getItem('currentUser'));let temp=\"\";if(currentUser!==null&&typeof currentUser==='object'){temp=currentUser.userData.username;}else{temp=\"\";}if(error){return/*#__PURE__*/_jsxs(\"div\",{children:[\"Error: \",error.message]});}else if(!isLoading){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}else{return/*#__PURE__*/_jsxs(\"div\",{className:\"post-details-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:data.title}),/*#__PURE__*/_jsxs(\"h4\",{children:[\"By: \",data.author.username]}),/*#__PURE__*/_jsx(\"p\",{children:data.content}),data.author.username===temp?/*#__PURE__*/_jsxs(\"div\",{className:\"buttons-container\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>ChangeRouteToUpdatePostForm(id),children:\"Update\"}),/*#__PURE__*/_jsx(\"button\",{onClick:deletePost,children:\"Delete\"})]}):/*#__PURE__*/_jsx(_Fragment,{}),temp?/*#__PURE__*/_jsx(\"button\",{onClick:()=>ChangeRouteToCommentForm(id),className:\"comment-button\",children:\"Comment\"}):/*#__PURE__*/_jsx(_Fragment,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"comments-container\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Comments:\"}),commentData.map(data=>/*#__PURE__*/_jsxs(\"div\",{className:\"comment-container\",children:[/*#__PURE__*/_jsx(\"p\",{children:data.comment}),/*#__PURE__*/_jsxs(\"em\",{children:[\"By: \",data.user_ref.username]}),data.user_ref.username===temp?/*#__PURE__*/_jsxs(\"div\",{className:\"comment-button-container\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>ChangeRouteToUpdateCommentForm(id,data),children:\"Update\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteComment(data),children:\"Delete\"})]}):/*#__PURE__*/_jsx(_Fragment,{})]}))]})]});}}","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","jsxs","_jsxs","jsx","_jsx","Fragment","_Fragment","PostDetails","navigate","id","data","setData","commentData","setCommentData","isLoading","setIsLoading","error","setError","currentUserToken","localStorage","getItem","deleteComment","response","fetch","concat","_id","method","headers","Authorization","ok","Error","console","log","window","location","reload","deletePost","e","preventDefault","ChangeRouteToUpdatePostForm","ChangeRouteToUpdateCommentForm","ChangeRouteToCommentForm","fetchData","resultComments","json","comments","result","post","currentUser","JSON","parse","temp","userData","username","children","message","className","title","author","content","onClick","map","comment","user_ref"],"sources":["C:/Users/17602/Documents/coding-exercises/TODP/Blog-Template/src/components/PostDetails.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useParams } from 'react-router-dom';\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nexport default function PostDetails() {\r\n  const navigate = useNavigate();\r\n  const { id } = useParams(); // Access the route parameter\r\n  const [data, setData] = useState();\r\n  const [commentData, setCommentData] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const currentUserToken = localStorage.getItem('token');\r\n  \r\n  const deleteComment = async (data) => {\r\n    try {\r\n      const response = await fetch(`http://localhost:3000/posts/${id}/comments/${data._id}`, {\r\n        method: 'DELETE',\r\n        headers: {\r\n          'Content-Type': 'application/json', \r\n          Authorization: currentUserToken // Set your headers if needed\r\n          // Add any other necessary headers\r\n        },\r\n        // You can include a body for some DELETE requests, but it's often not required\r\n        // body: JSON.stringify({ /* any data if needed */ }),\r\n      });\r\n      if (!response.ok) {\r\n        throw new Error('Network response was not ok');\r\n      }\r\n      // Handle success if needed\r\n      console.log('Item deleted successfully');\r\n      window.location.reload();\r\n    } catch(error) {\r\n      // Handle error if any\r\n      console.error('There was a problem deleting the item:', error);\r\n    }\r\n  };\r\n\r\n  const deletePost = async (e) => {\r\n    e.preventDefault();\r\n    try {\r\n      const response = await fetch(`http://localhost:3000/posts/${id}`, {\r\n        method: 'DELETE',\r\n        headers: {\r\n          'Content-Type': 'application/json', \r\n          Authorization: currentUserToken // Set your headers if needed\r\n          // Add any other necessary headers\r\n        },\r\n        // You can include a body for some DELETE requests, but it's often not required\r\n        // body: JSON.stringify({ /* any data if needed */ }),\r\n      });\r\n      if (!response.ok) {\r\n        throw new Error('Network response was not ok');\r\n      }\r\n      // Handle success if needed\r\n      console.log('Item deleted successfully');\r\n      navigate(\"/\");\r\n    } catch(error) {\r\n      // Handle error if any\r\n      console.error('There was a problem deleting the item:', error);\r\n    }\r\n  };\r\n\r\n  const ChangeRouteToUpdatePostForm = (id) => {\r\n    navigate(\"/update-posts/\"+id);\r\n  }\r\n  const ChangeRouteToUpdateCommentForm = (id, data) => {\r\n    navigate(\"/update-comments/\"+id+\"/\"+data._id);\r\n  }\r\n  const ChangeRouteToCommentForm = (id) => {\r\n    navigate(\"/comment-form/\"+id);\r\n  }\r\n  \r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        const response = await fetch('http://localhost:3000/posts/'+id+'/comments');\r\n        if (!response.ok) {\r\n           throw new Error('Network response was not ok.');\r\n        }\r\n        const resultComments = await response.json();\r\n        setCommentData(resultComments.comments);\r\n      } catch (error) {\r\n        setError(error);\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n  }, [id]);\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        const response = await fetch('http://localhost:3000/posts/'+id);\r\n        if (!response.ok) {\r\n          throw new Error('Network response was not ok.');\r\n        }\r\n        const result = await response.json();\r\n        setIsLoading(true);\r\n        setData(result.post);\r\n      } catch (error) {\r\n        setIsLoading(true);\r\n        setError(error);\r\n      } \r\n    };\r\n\r\n    fetchData();\r\n  }, [error, id, isLoading]);\r\n\r\n  let currentUser = JSON.parse(localStorage.getItem('currentUser'));\r\n  let temp = \"\"\r\n  if (currentUser !== null && typeof currentUser === 'object') {\r\n    temp = currentUser.userData.username;\r\n  } else {\r\n    temp = \"\";\r\n  }\r\n  \r\n  if (error) {\r\n    return <div>Error: {error.message}</div>;\r\n  } else if (!isLoading) {\r\n    return <div>Loading...</div>;\r\n  } else {\r\n  return (\r\n    <div className=\"post-details-container\">\r\n      \r\n      <h2>{data.title}</h2>\r\n      <h4>By: {data.author.username}</h4>\r\n      <p>{data.content}</p>\r\n      \r\n        {(data.author.username === temp) ?\r\n          <div className=\"buttons-container\">\r\n            <button onClick={() => ChangeRouteToUpdatePostForm(id)}>Update</button>\r\n            <button onClick={deletePost}>Delete</button>\r\n          </div> :\r\n          <></>\r\n        }\r\n      {(temp) ?\r\n        <button onClick={() => ChangeRouteToCommentForm(id)} className=\"comment-button\">Comment</button>\r\n        :\r\n        <></>\r\n      }\r\n      <div className=\"comments-container\">\r\n      <h3>Comments:</h3>\r\n        {commentData.map((data) => (\r\n          <div className=\"comment-container\">\r\n            <p>{data.comment}</p>\r\n            <em>By: {data.user_ref.username}</em>\r\n            {(data.user_ref.username === temp) ?\r\n              <div className=\"comment-button-container\">\r\n                <button onClick={() => ChangeRouteToUpdateCommentForm(id, data)}>Update</button>\r\n                <button onClick={() => deleteComment(data)}>Delete</button>\r\n              </div> :\r\n              <></>\r\n            }\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n        }\r\n}\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}